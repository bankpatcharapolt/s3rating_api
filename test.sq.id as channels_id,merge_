SELECT r1.tvchannels_id,r1.hour as hour ,r1.MINUTE as minute,CONVERT(varchar(12),tvchannels_id) + '_'+(CONVERT(varchar(12),r1.hour) + '_' + CONVERT(varchar(12),r1.MINUTE)) AS h_m  ,Count(case when r1.d_0_0 >= 1 then 1 end) as 'field_0_0' ,Count(case when r1.d_0_10 >= 1 then 1 end) as 'field_0_10' ,Count(case when r1.d_0_20 >= 1 then 1 end) as 'field_0_20' ,Count(case when r1.d_0_30 >= 1 then 1 end) as 'field_0_30' ,Count(case when r1.d_0_40 >= 1 then 1 end) as 'field_0_40' ,Count(case when r1.d_0_50 >= 1 then 1 end) as 'field_0_50' ,Count(case when r1.d_5_0 >= 1 then 1 end) as 'field_5_0' ,Count(case when r1.d_5_10 >= 1 then 1 end) as 'field_5_10' ,Count(case when r1.d_5_20 >= 1 then 1 end) as 'field_5_20' ,Count(case when r1.d_5_30 >= 1 then 1 end) as 'field_5_30' ,Count(case when r1.d_5_40 >= 1 then 1 end) as 'field_5_40' ,Count(case when r1.d_5_50 >= 1 then 1 end) as 'field_5_50' ,Count(case when r1.d_6_0 >= 1 then 1 end) as 'field_6_0' ,Count(case when r1.d_6_10 >= 1 then 1 end) as 'field_6_10' ,Count(case when r1.d_6_20 >= 1 then 1 end) as 'field_6_20' ,Count(case when r1.d_6_30 >= 1 then 1 end) as 'field_6_30' ,Count(case when r1.d_6_40 >= 1 then 1 end) as 'field_6_40' ,Count(case when r1.d_6_50 >= 1 then 1 end) as 'field_6_50' ,Count(case when r1.d_7_0 >= 1 then 1 end) as 'field_7_0' ,Count(case when r1.d_7_10 >= 1 then 1 end) as 'field_7_10' ,Count(case when r1.d_7_20 >= 1 then 1 end) as 'field_7_20' ,Count(case when r1.d_7_30 >= 1 then 1 end) as 'field_7_30' ,Count(case when r1.d_7_40 >= 1 then 1 end) as 'field_7_40' ,Count(case when r1.d_7_50 >= 1 then 1 end) as 'field_7_50' ,Count(case when r1.d_8_0 >= 1 then 1 end) as 'field_8_0' ,Count(case when r1.d_8_10 >= 1 then 1 end) as 'field_8_10' ,Count(case when r1.d_8_20 >= 1 then 1 end) as 'field_8_20' ,Count(case when r1.d_8_30 >= 1 then 1 end) as 'field_8_30' ,Count(case when r1.d_8_40 >= 1 then 1 end) as 'field_8_40' ,Count(case when r1.d_8_50 >= 1 then 1 end) as 'field_8_50' ,Count(case when r1.d_9_0 >= 1 then 1 end) as 'field_9_0' ,Count(case when r1.d_9_10 >= 1 then 1 end) as 'field_9_10' ,Count(case when r1.d_9_20 >= 1 then 1 end) as 'field_9_20' ,Count(case when r1.d_9_30 >= 1 then 1 end) as 'field_9_30' ,Count(case when r1.d_9_40 >= 1 then 1 end) as 'field_9_40' ,Count(case when r1.d_9_50 >= 1 then 1 end) as 'field_9_50' ,Count(case when r1.d_10_0 >= 1 then 1 end) as 'field_10_0' ,Count(case when r1.d_10_10 >= 1 then 1 end) as 'field_10_10' ,Count(case when r1.d_10_20 >= 1 then 1 end) as 'field_10_20' ,Count(case when r1.d_10_30 >= 1 then 1 end) as 'field_10_30' ,Count(case when r1.d_10_40 >= 1 then 1 end) as 'field_10_40' ,Count(case when r1.d_10_50 >= 1 then 1 end) as 'field_10_50' ,Count(case when r1.d_11_0 >= 1 then 1 end) as 'field_11_0' ,Count(case when r1.d_11_10 >= 1 then 1 end) as 'field_11_10' ,Count(case when r1.d_11_20 >= 1 then 1 end) as 'field_11_20' ,Count(case when r1.d_11_30 >= 1 then 1 end) as 'field_11_30' ,Count(case when r1.d_11_40 >= 1 then 1 end) as 'field_11_40' ,Count(case when r1.d_11_50 >= 1 then 1 end) as 'field_11_50' ,Count(case when r1.d_12_0 >= 1 then 1 end) as 'field_12_0' ,Count(case when r1.d_12_10 >= 1 then 1 end) as 'field_12_10' ,Count(case when r1.d_12_20 >= 1 then 1 end) as 'field_12_20' ,Count(case when r1.d_12_30 >= 1 then 1 end) as 'field_12_30' ,Count(case when r1.d_12_40 >= 1 then 1 end) as 'field_12_40' ,Count(case when r1.d_12_50 >= 1 then 1 end) as 'field_12_50' ,Count(case when r1.d_13_0 >= 1 then 1 end) as 'field_13_0' ,Count(case when r1.d_13_10 >= 1 then 1 end) as 'field_13_10' ,Count(case when r1.d_13_20 >= 1 then 1 end) as 'field_13_20' ,Count(case when r1.d_13_30 >= 1 then 1 end) as 'field_13_30' ,Count(case when r1.d_13_40 >= 1 then 1 end) as 'field_13_40' ,Count(case when r1.d_13_50 >= 1 then 1 end) as 'field_13_50' ,Count(case when r1.d_14_0 >= 1 then 1 end) as 'field_14_0' ,Count(case when r1.d_14_10 >= 1 then 1 end) as 'field_14_10' ,Count(case when r1.d_14_20 >= 1 then 1 end) as 'field_14_20' ,Count(case when r1.d_14_30 >= 1 then 1 end) as 'field_14_30' ,Count(case when r1.d_14_40 >= 1 then 1 end) as 'field_14_40' ,Count(case when r1.d_14_50 >= 1 then 1 end) as 'field_14_50' ,Count(case when r1.d_15_0 >= 1 then 1 end) as 'field_15_0' ,Count(case when r1.d_15_10 >= 1 then 1 end) as 'field_15_10' ,Count(case when r1.d_15_20 >= 1 then 1 end) as 'field_15_20' ,Count(case when r1.d_15_30 >= 1 then 1 end) as 'field_15_30' ,Count(case when r1.d_15_40 >= 1 then 1 end) as 'field_15_40' ,Count(case when r1.d_15_50 >= 1 then 1 end) as 'field_15_50' ,Count(case when r1.d_16_0 >= 1 then 1 end) as 'field_16_0' ,Count(case when r1.d_16_10 >= 1 then 1 end) as 'field_16_10' ,Count(case when r1.d_16_20 >= 1 then 1 end) as 'field_16_20' ,Count(case when r1.d_16_30 >= 1 then 1 end) as 'field_16_30' ,Count(case when r1.d_16_40 >= 1 then 1 end) as 'field_16_40' ,Count(case when r1.d_16_50 >= 1 then 1 end) as 'field_16_50' ,Count(case when r1.d_17_0 >= 1 then 1 end) as 'field_17_0' ,Count(case when r1.d_17_10 >= 1 then 1 end) as 'field_17_10' ,Count(case when r1.d_17_20 >= 1 then 1 end) as 'field_17_20' ,Count(case when r1.d_17_30 >= 1 then 1 end) as 'field_17_30' ,Count(case when r1.d_17_40 >= 1 then 1 end) as 'field_17_40' ,Count(case when r1.d_17_50 >= 1 then 1 end) as 'field_17_50' ,Count(case when r1.d_18_0 >= 1 then 1 end) as 'field_18_0' ,Count(case when r1.d_18_10 >= 1 then 1 end) as 'field_18_10' ,Count(case when r1.d_18_20 >= 1 then 1 end) as 'field_18_20' ,Count(case when r1.d_18_30 >= 1 then 1 end) as 'field_18_30' ,Count(case when r1.d_18_40 >= 1 then 1 end) as 'field_18_40' ,Count(case when r1.d_18_50 >= 1 then 1 end) as 'field_18_50' ,Count(case when r1.d_19_0 >= 1 then 1 end) as 'field_19_0' ,Count(case when r1.d_19_10 >= 1 then 1 end) as 'field_19_10' ,Count(case when r1.d_19_20 >= 1 then 1 end) as 'field_19_20' ,Count(case when r1.d_19_30 >= 1 then 1 end) as 'field_19_30' ,Count(case when r1.d_19_40 >= 1 then 1 end) as 'field_19_40' ,Count(case when r1.d_19_50 >= 1 then 1 end) as 'field_19_50' ,Count(case when r1.d_20_0 >= 1 then 1 end) as 'field_20_0' ,Count(case when r1.d_20_10 >= 1 then 1 end) as 'field_20_10' ,Count(case when r1.d_20_20 >= 1 then 1 end) as 'field_20_20' ,Count(case when r1.d_20_30 >= 1 then 1 end) as 'field_20_30' ,Count(case when r1.d_20_40 >= 1 then 1 end) as 'field_20_40' ,Count(case when r1.d_20_50 >= 1 then 1 end) as 'field_20_50' ,Count(case when r1.d_21_0 >= 1 then 1 end) as 'field_21_0' ,Count(case when r1.d_21_10 >= 1 then 1 end) as 'field_21_10' ,Count(case when r1.d_21_20 >= 1 then 1 end) as 'field_21_20' ,Count(case when r1.d_21_30 >= 1 then 1 end) as 'field_21_30' ,Count(case when r1.d_21_40 >= 1 then 1 end) as 'field_21_40' ,Count(case when r1.d_21_50 >= 1 then 1 end) as 'field_21_50' ,Count(case when r1.d_22_0 >= 1 then 1 end) as 'field_22_0' ,Count(case when r1.d_22_10 >= 1 then 1 end) as 'field_22_10' ,Count(case when r1.d_22_20 >= 1 then 1 end) as 'field_22_20' ,Count(case when r1.d_22_30 >= 1 then 1 end) as 'field_22_30' ,Count(case when r1.d_22_40 >= 1 then 1 end) as 'field_22_40' ,Count(case when r1.d_22_50 >= 1 then 1 end) as 'field_22_50' ,Count(case when r1.d_23_0 >= 1 then 1 end) as 'field_23_0' ,Count(case when r1.d_23_10 >= 1 then 1 end) as 'field_23_10' ,Count(case when r1.d_23_20 >= 1 then 1 end) as 'field_23_20' ,Count(case when r1.d_23_30 >= 1 then 1 end) as 'field_23_30' ,Count(case when r1.d_23_40 >= 1 then 1 end) as 'field_23_40' ,Count(case when r1.d_23_50 >= 1 then 1 end) as 'field_23_50' FROM ( SELECT  DATEPART(HOUR, startview_datetime) as hour,CAST(DATEPART(MINUTE,dateadd(minute,(datediff(minute,0,startview_datetime)/10)*10,0)) AS char(2)) as MINUTE,devices_id,count(*) as count_allratingrecord ,tvchannels_id,COUNT(CASE WHEN startview_datetime > '2024-03-31 00:00:00' AND startview_datetime < '2024-03-31 00:10:00' THEN 1 END ) AS 'd_0_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 00:10:00' AND startview_datetime < '2024-03-31 00:20:00' THEN 1 END ) AS 'd_0_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 00:20:00' AND startview_datetime < '2024-03-31 00:30:00' THEN 1 END ) AS 'd_0_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 00:30:00' AND startview_datetime < '2024-03-31 00:40:00' THEN 1 END ) AS 'd_0_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 00:40:00' AND startview_datetime < '2024-03-31 00:50:00' THEN 1 END ) AS 'd_0_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 00:50:00' AND startview_datetime < '2024-03-31 01:00:00' THEN 1 END ) AS 'd_0_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:00:00' AND startview_datetime < '2024-03-31 05:10:00' THEN 1 END ) AS 'd_5_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:10:00' AND startview_datetime < '2024-03-31 05:20:00' THEN 1 END ) AS 'd_5_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:20:00' AND startview_datetime < '2024-03-31 05:30:00' THEN 1 END ) AS 'd_5_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:30:00' AND startview_datetime < '2024-03-31 05:40:00' THEN 1 END ) AS 'd_5_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:40:00' AND startview_datetime < '2024-03-31 05:50:00' THEN 1 END ) AS 'd_5_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 05:50:00' AND startview_datetime < '2024-03-31 06:00:00' THEN 1 END ) AS 'd_5_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:00:00' AND startview_datetime < '2024-03-31 06:10:00' THEN 1 END ) AS 'd_6_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:10:00' AND startview_datetime < '2024-03-31 06:20:00' THEN 1 END ) AS 'd_6_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:20:00' AND startview_datetime < '2024-03-31 06:30:00' THEN 1 END ) AS 'd_6_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:30:00' AND startview_datetime < '2024-03-31 06:40:00' THEN 1 END ) AS 'd_6_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:40:00' AND startview_datetime < '2024-03-31 06:50:00' THEN 1 END ) AS 'd_6_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 06:50:00' AND startview_datetime < '2024-03-31 07:00:00' THEN 1 END ) AS 'd_6_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:00:00' AND startview_datetime < '2024-03-31 07:10:00' THEN 1 END ) AS 'd_7_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:10:00' AND startview_datetime < '2024-03-31 07:20:00' THEN 1 END ) AS 'd_7_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:20:00' AND startview_datetime < '2024-03-31 07:30:00' THEN 1 END ) AS 'd_7_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:30:00' AND startview_datetime < '2024-03-31 07:40:00' THEN 1 END ) AS 'd_7_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:40:00' AND startview_datetime < '2024-03-31 07:50:00' THEN 1 END ) AS 'd_7_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 07:50:00' AND startview_datetime < '2024-03-31 08:00:00' THEN 1 END ) AS 'd_7_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:00:00' AND startview_datetime < '2024-03-31 08:10:00' THEN 1 END ) AS 'd_8_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:10:00' AND startview_datetime < '2024-03-31 08:20:00' THEN 1 END ) AS 'd_8_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:20:00' AND startview_datetime < '2024-03-31 08:30:00' THEN 1 END ) AS 'd_8_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:30:00' AND startview_datetime < '2024-03-31 08:40:00' THEN 1 END ) AS 'd_8_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:40:00' AND startview_datetime < '2024-03-31 08:50:00' THEN 1 END ) AS 'd_8_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 08:50:00' AND startview_datetime < '2024-03-31 09:00:00' THEN 1 END ) AS 'd_8_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:00:00' AND startview_datetime < '2024-03-31 09:10:00' THEN 1 END ) AS 'd_9_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:10:00' AND startview_datetime < '2024-03-31 09:20:00' THEN 1 END ) AS 'd_9_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:20:00' AND startview_datetime < '2024-03-31 09:30:00' THEN 1 END ) AS 'd_9_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:30:00' AND startview_datetime < '2024-03-31 09:40:00' THEN 1 END ) AS 'd_9_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:40:00' AND startview_datetime < '2024-03-31 09:50:00' THEN 1 END ) AS 'd_9_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 09:50:00' AND startview_datetime < '2024-03-31 10:00:00' THEN 1 END ) AS 'd_9_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:00:00' AND startview_datetime < '2024-03-31 10:10:00' THEN 1 END ) AS 'd_10_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:10:00' AND startview_datetime < '2024-03-31 10:20:00' THEN 1 END ) AS 'd_10_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:20:00' AND startview_datetime < '2024-03-31 10:30:00' THEN 1 END ) AS 'd_10_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:30:00' AND startview_datetime < '2024-03-31 10:40:00' THEN 1 END ) AS 'd_10_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:40:00' AND startview_datetime < '2024-03-31 10:50:00' THEN 1 END ) AS 'd_10_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 10:50:00' AND startview_datetime < '2024-03-31 11:00:00' THEN 1 END ) AS 'd_10_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:00:00' AND startview_datetime < '2024-03-31 11:10:00' THEN 1 END ) AS 'd_11_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:10:00' AND startview_datetime < '2024-03-31 11:20:00' THEN 1 END ) AS 'd_11_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:20:00' AND startview_datetime < '2024-03-31 11:30:00' THEN 1 END ) AS 'd_11_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:30:00' AND startview_datetime < '2024-03-31 11:40:00' THEN 1 END ) AS 'd_11_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:40:00' AND startview_datetime < '2024-03-31 11:50:00' THEN 1 END ) AS 'd_11_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 11:50:00' AND startview_datetime < '2024-03-31 12:00:00' THEN 1 END ) AS 'd_11_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:00:00' AND startview_datetime < '2024-03-31 12:10:00' THEN 1 END ) AS 'd_12_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:10:00' AND startview_datetime < '2024-03-31 12:20:00' THEN 1 END ) AS 'd_12_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:20:00' AND startview_datetime < '2024-03-31 12:30:00' THEN 1 END ) AS 'd_12_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:30:00' AND startview_datetime < '2024-03-31 12:40:00' THEN 1 END ) AS 'd_12_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:40:00' AND startview_datetime < '2024-03-31 12:50:00' THEN 1 END ) AS 'd_12_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 12:50:00' AND startview_datetime < '2024-03-31 13:00:00' THEN 1 END ) AS 'd_12_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:00:00' AND startview_datetime < '2024-03-31 13:10:00' THEN 1 END ) AS 'd_13_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:10:00' AND startview_datetime < '2024-03-31 13:20:00' THEN 1 END ) AS 'd_13_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:20:00' AND startview_datetime < '2024-03-31 13:30:00' THEN 1 END ) AS 'd_13_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:30:00' AND startview_datetime < '2024-03-31 13:40:00' THEN 1 END ) AS 'd_13_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:40:00' AND startview_datetime < '2024-03-31 13:50:00' THEN 1 END ) AS 'd_13_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 13:50:00' AND startview_datetime < '2024-03-31 14:00:00' THEN 1 END ) AS 'd_13_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:00:00' AND startview_datetime < '2024-03-31 14:10:00' THEN 1 END ) AS 'd_14_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:10:00' AND startview_datetime < '2024-03-31 14:20:00' THEN 1 END ) AS 'd_14_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:20:00' AND startview_datetime < '2024-03-31 14:30:00' THEN 1 END ) AS 'd_14_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:30:00' AND startview_datetime < '2024-03-31 14:40:00' THEN 1 END ) AS 'd_14_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:40:00' AND startview_datetime < '2024-03-31 14:50:00' THEN 1 END ) AS 'd_14_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 14:50:00' AND startview_datetime < '2024-03-31 15:00:00' THEN 1 END ) AS 'd_14_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:00:00' AND startview_datetime < '2024-03-31 15:10:00' THEN 1 END ) AS 'd_15_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:10:00' AND startview_datetime < '2024-03-31 15:20:00' THEN 1 END ) AS 'd_15_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:20:00' AND startview_datetime < '2024-03-31 15:30:00' THEN 1 END ) AS 'd_15_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:30:00' AND startview_datetime < '2024-03-31 15:40:00' THEN 1 END ) AS 'd_15_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:40:00' AND startview_datetime < '2024-03-31 15:50:00' THEN 1 END ) AS 'd_15_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 15:50:00' AND startview_datetime < '2024-03-31 16:00:00' THEN 1 END ) AS 'd_15_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:00:00' AND startview_datetime < '2024-03-31 16:10:00' THEN 1 END ) AS 'd_16_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:10:00' AND startview_datetime < '2024-03-31 16:20:00' THEN 1 END ) AS 'd_16_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:20:00' AND startview_datetime < '2024-03-31 16:30:00' THEN 1 END ) AS 'd_16_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:30:00' AND startview_datetime < '2024-03-31 16:40:00' THEN 1 END ) AS 'd_16_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:40:00' AND startview_datetime < '2024-03-31 16:50:00' THEN 1 END ) AS 'd_16_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 16:50:00' AND startview_datetime < '2024-03-31 17:00:00' THEN 1 END ) AS 'd_16_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:00:00' AND startview_datetime < '2024-03-31 17:10:00' THEN 1 END ) AS 'd_17_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:10:00' AND startview_datetime < '2024-03-31 17:20:00' THEN 1 END ) AS 'd_17_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:20:00' AND startview_datetime < '2024-03-31 17:30:00' THEN 1 END ) AS 'd_17_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:30:00' AND startview_datetime < '2024-03-31 17:40:00' THEN 1 END ) AS 'd_17_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:40:00' AND startview_datetime < '2024-03-31 17:50:00' THEN 1 END ) AS 'd_17_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 17:50:00' AND startview_datetime < '2024-03-31 18:00:00' THEN 1 END ) AS 'd_17_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:00:00' AND startview_datetime < '2024-03-31 18:10:00' THEN 1 END ) AS 'd_18_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:10:00' AND startview_datetime < '2024-03-31 18:20:00' THEN 1 END ) AS 'd_18_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:20:00' AND startview_datetime < '2024-03-31 18:30:00' THEN 1 END ) AS 'd_18_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:30:00' AND startview_datetime < '2024-03-31 18:40:00' THEN 1 END ) AS 'd_18_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:40:00' AND startview_datetime < '2024-03-31 18:50:00' THEN 1 END ) AS 'd_18_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 18:50:00' AND startview_datetime < '2024-03-31 19:00:00' THEN 1 END ) AS 'd_18_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:00:00' AND startview_datetime < '2024-03-31 19:10:00' THEN 1 END ) AS 'd_19_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:10:00' AND startview_datetime < '2024-03-31 19:20:00' THEN 1 END ) AS 'd_19_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:20:00' AND startview_datetime < '2024-03-31 19:30:00' THEN 1 END ) AS 'd_19_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:30:00' AND startview_datetime < '2024-03-31 19:40:00' THEN 1 END ) AS 'd_19_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:40:00' AND startview_datetime < '2024-03-31 19:50:00' THEN 1 END ) AS 'd_19_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 19:50:00' AND startview_datetime < '2024-03-31 20:00:00' THEN 1 END ) AS 'd_19_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:00:00' AND startview_datetime < '2024-03-31 20:10:00' THEN 1 END ) AS 'd_20_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:10:00' AND startview_datetime < '2024-03-31 20:20:00' THEN 1 END ) AS 'd_20_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:20:00' AND startview_datetime < '2024-03-31 20:30:00' THEN 1 END ) AS 'd_20_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:30:00' AND startview_datetime < '2024-03-31 20:40:00' THEN 1 END ) AS 'd_20_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:40:00' AND startview_datetime < '2024-03-31 20:50:00' THEN 1 END ) AS 'd_20_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 20:50:00' AND startview_datetime < '2024-03-31 21:00:00' THEN 1 END ) AS 'd_20_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:00:00' AND startview_datetime < '2024-03-31 21:10:00' THEN 1 END ) AS 'd_21_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:10:00' AND startview_datetime < '2024-03-31 21:20:00' THEN 1 END ) AS 'd_21_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:20:00' AND startview_datetime < '2024-03-31 21:30:00' THEN 1 END ) AS 'd_21_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:30:00' AND startview_datetime < '2024-03-31 21:40:00' THEN 1 END ) AS 'd_21_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:40:00' AND startview_datetime < '2024-03-31 21:50:00' THEN 1 END ) AS 'd_21_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 21:50:00' AND startview_datetime < '2024-03-31 22:00:00' THEN 1 END ) AS 'd_21_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:00:00' AND startview_datetime < '2024-03-31 22:10:00' THEN 1 END ) AS 'd_22_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:10:00' AND startview_datetime < '2024-03-31 22:20:00' THEN 1 END ) AS 'd_22_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:20:00' AND startview_datetime < '2024-03-31 22:30:00' THEN 1 END ) AS 'd_22_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:30:00' AND startview_datetime < '2024-03-31 22:40:00' THEN 1 END ) AS 'd_22_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:40:00' AND startview_datetime < '2024-03-31 22:50:00' THEN 1 END ) AS 'd_22_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 22:50:00' AND startview_datetime < '2024-03-31 23:00:00' THEN 1 END ) AS 'd_22_50',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:00:00' AND startview_datetime < '2024-03-31 23:10:00' THEN 1 END ) AS 'd_23_0',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:10:00' AND startview_datetime < '2024-03-31 23:20:00' THEN 1 END ) AS 'd_23_10',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:20:00' AND startview_datetime < '2024-03-31 23:30:00' THEN 1 END ) AS 'd_23_20',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:30:00' AND startview_datetime < '2024-03-31 23:40:00' THEN 1 END ) AS 'd_23_30',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:40:00' AND startview_datetime < '2024-03-31 23:50:00' THEN 1 END ) AS 'd_23_40',COUNT(CASE WHEN startview_datetime > '2024-03-31 23:50:00' AND startview_datetime < '2024-04-01 00:00:00' THEN 1 END ) AS 'd_23_50' FROM #temp_table_iptv WHERE startview_datetime >= '2024-03-31 00:00:01' AND startview_datetime <= '2024-03-31 23:59:59' AND tvchannels_id > 0   GROUP BY  tvchannels_id, DATEPART(YEAR, startview_datetime),DATEPART(MONTH, startview_datetime),DATEPART(DAY, startview_datetime),DATEPART(HOUR, startview_datetime),dateadd(minute,(datediff(minute,0,startview_datetime)/10)*10,0),devices_id )r1 group by r1.hour,r1.MINUTE,r1.tvchannels_id order by r1.tvchannels_id,r1.hour,r1.MINUTE